<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>UtilsExtensions.kt</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">app</a> &gt; <a href="index.source.html" class="el_package">com.sugarspoon.eventcheckin.utils</a> &gt; <span class="el_source">UtilsExtensions.kt</span></div><h1>UtilsExtensions.kt</h1><pre class="source lang-java linenums">package com.sugarspoon.eventcheckin.utils

import android.annotation.SuppressLint
import android.content.Context
import android.graphics.drawable.Drawable
import android.location.Geocoder
import android.os.Build
import android.text.Html
import android.text.Spanned
import android.util.Patterns
import androidx.appcompat.widget.AppCompatImageView
import com.bumptech.glide.Glide
import com.bumptech.glide.load.engine.GlideException
import com.bumptech.glide.request.RequestListener
import java.sql.Timestamp
import java.text.SimpleDateFormat
import java.util.*

@SuppressLint(&quot;CheckResult&quot;)
<span class="nc" id="L20">fun AppCompatImageView.loadImage(</span>
    context: Context,
    url: String,
<span class="nc" id="L23">    onError: (() -&gt; Unit)? = null,</span>
<span class="nc" id="L24">    onLoading: ((Boolean) -&gt; Unit)? = null,</span>
<span class="nc" id="L25">    onSuccess: (() -&gt; Unit)? = null</span>
) {
<span class="nc bnc" id="L27" title="All 2 branches missed.">    onLoading?.invoke(true)</span>
<span class="nc" id="L28">    Glide.with(context)</span>
<span class="nc" id="L29">        .load(url.fixProtocol())</span>
<span class="nc" id="L30">        .centerCrop()</span>
<span class="nc" id="L31">        .listener(</span>
            @SuppressLint(&quot;CheckResult&quot;)
<span class="nc" id="L33">            object : RequestListener&lt;Drawable?&gt; {</span>

                override fun onLoadFailed(
                    e: GlideException?,
                    model: Any?,
                    target: com.bumptech.glide.request.target.Target&lt;Drawable?&gt;?,
                    isFirstResource: Boolean
                ): Boolean {
                    onError?.invoke()
                    onLoading?.invoke(false)
                    return false
                }

                override fun onResourceReady(
                    resource: Drawable?,
                    model: Any?,
                    target: com.bumptech.glide.request.target.Target&lt;Drawable?&gt;?,
                    dataSource: com.bumptech.glide.load.DataSource?,
                    isFirstResource: Boolean
                ): Boolean {
                    onSuccess?.invoke()
                    onLoading?.invoke(false)
                    return false
                }
            }
        )
<span class="nc" id="L59">        .into(this)</span>
<span class="nc" id="L60">}</span>

private fun String.fixProtocol() : String {
<span class="nc bnc" id="L63" title="All 2 branches missed.">    return if (this.take(5).contains(&quot;https&quot;)) {</span>
<span class="nc" id="L64">        this</span>
    } else {
<span class="nc" id="L66">        replace(&quot;http&quot;, &quot;https&quot;)</span>
    }
}

fun Context.getAddress(
    latitude: Double,
    longitude: Double
) : String {
<span class="nc" id="L74">    return  Geocoder(this, Locale.getDefault()).getFromLocation(latitude, longitude, 1)[0].getAddressLine(0)</span>
}

fun Number.toLocalDate(): String {
<span class="nc" id="L78">    return try {</span>
<span class="nc" id="L79">        val sdf = SimpleDateFormat(&quot;dd/MM/yyyy&quot;, Locale.getDefault())</span>
<span class="nc" id="L80">        val netDate = Date(Timestamp(toLong()).time)</span>
<span class="nc" id="L81">        sdf.format(netDate)</span>
<span class="nc" id="L82">    } catch (e: Exception) {</span>
<span class="nc" id="L83">        e.toString()</span>
    }
}

<span class="nc bnc" id="L87" title="All 2 branches missed.">fun String.toHtml(): Spanned = if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.N) {</span>
<span class="nc" id="L88">    Html.fromHtml(this, Html.FROM_HTML_MODE_LEGACY)</span>
<span class="nc" id="L89">} else {</span>
<span class="nc" id="L90">    Html.fromHtml(this)</span>
<span class="nc" id="L91">}</span>

fun String.isValidEmail(): Boolean {
<span class="nc bnc" id="L94" title="All 6 branches missed.">    return this.isNotEmpty() &amp;&amp; Patterns.EMAIL_ADDRESS.matcher(this).matches().not()</span>
}

fun String.isValidName(): Boolean {
<span class="nc bnc" id="L98" title="All 4 branches missed.">    return this.isNotEmpty() and(this.split(&quot; &quot;).size &gt;= 2)</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>